"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function Chat(t,e){t&&(this.canvas=t,this.conversation=e,this.chat=document.createElement("ul"),this.answers=document.createElement("div"),this.chat.className="chat__list",this.answers.className="chat__answers",this.canvas.appendChild(this.chat),this.canvas.appendChild(this.answers),this.say("start"))}Chat.prototype.createBubble=function(t,e){var n=document.createElement("div");return n.className=1==e?"chat__bubble chat__bubble--response":"chat__bubble",n.innerHTML=t,n},Chat.prototype.addBubble=function(t,e){e=Object.assign({},{end:function(){},animate:!0},e);var n=document.createElement("li");if(n.className="chat__item",n.appendChild(t),1==e.animate){var a=t.innerHTML;t.innerHTML="â€¦",t.style.transform="translate( -4em, 0 )",t.style.opacity="0",setTimeout(function(){t.style.transform="translate( 0, 0 )",t.style.opacity="1"},30),setTimeout(function(){t.innerHTML=a,e.end.call(this,n)}.bind(this),800)}this.chat.appendChild(n)},Chat.prototype.addAnswer=function(t,e){e=Object.assign({},{delay:0,end:function(){}},e);t.style.transform="translate( 0, 3em )",t.style.opacity="0",setTimeout(function(){t.style.transform="translate( 0, 0 )",t.style.opacity="1"},e.delay),t.addEventListener("transitionend",e.end.bind(this,t),!1),this.answers.appendChild(t)},Chat.prototype.animateAnswer=function(e,t){t=Object.assign({},{end:function(){}},t);[].slice.call(e.parentNode.children).forEach(function(t){t!=e&&(t.style.transform="translate( 0, 3em )",t.style.opacity="0")});var n=e.cloneNode(!0);n.style.visibility="hidden",this.addBubble(n,{animate:!1});var a=n.getBoundingClientRect();n.style.display="none";var i=e.getBoundingClientRect();e.addEventListener("transitionend",function(){this.answers.innerHTML="",n.style.visibility="",n.style.display="",t.end.call(this)}.bind(this)),e.style.transform="translate("+(a.left-i.left)+"px,"+(a.top-i.top)+"px)"},Chat.prototype.chooseAnswer=function(t){(t=t instanceof Array?t:[t]).forEach(function(t,e){var n=this.createBubble(t.text,!0);n.addEventListener("click",function(){this.animateAnswer(n,{end:function(){"path"in t&&this.say(t.path),"callback"in t&&t.callback.call(this)}})}.bind(this)),this.addAnswer(n,{delay:50*e})}.bind(this))},Chat.prototype.writeAnswer=function(e){var n=this,a=this.createBubble("",!0);function i(){if(a.innerText){a.contentEditable=!1;var t=a.innerText;n.animateAnswer(a,{end:function(){"path"in e&&n.say(e.path),"callback"in e&&e.callback.call(n,t)}})}}a.classList.add("chat__bubble--input"),a.contentEditable=!0,a.addEventListener("paste",function(t){requestAnimationFrame(function(){a.innerHTML=a.innerText})}),a.addEventListener("blur",i),a.addEventListener("keydown",function(t){13==t.keyCode&&(t.preventDefault(),a.removeEventListener("blur",i),i())}),this.addAnswer(a,{end:function(){a.focus()}})},Chat.prototype.say=function(t){for(var e=(e=this.conversation[t])instanceof Array?e:[e],n=0;n<e.length;n++)setTimeout(function(t){if("object"==(void 0===t?"undefined":_typeof(t)))"choose"==t.type?this.chooseAnswer(t.answers):"text"==t.type&&this.writeAnswer(t);else{var e=this.createBubble(t);this.addBubble(e)}}.bind(this,e[n]),1200*n+350)};
//# sourceMappingURL=chat.min.js.map
