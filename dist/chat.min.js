"use strict";function Chat(t,e){t&&(this.canvas=t,this.conversation=e,this.chat=document.createElement("ul"),this.answers=document.createElement("div"),this.chat.className="chat__list",this.answers.className="chat__answers",this.canvas.appendChild(this.chat),this.canvas.appendChild(this.answers),this.say("start"))}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};Chat.prototype.createBubble=function(t,e){var n=document.createElement("div");return n.className=1==e?"chat__bubble chat__bubble--response":"chat__bubble",n.innerHTML=t,n},Chat.prototype.addBubble=function(t,e){var e=Object.assign({},{end:function(){},animate:!0},e),n=document.createElement("li");if(n.className="chat__item",n.appendChild(t),1==e.animate){var a=t.innerHTML;t.innerHTML="…",t.style.transform="translate( -4em, 0 )",t.style.opacity="0",setTimeout(function(){t.style.transform="translate( 0, 0 )",t.style.opacity="1"},30),setTimeout(function(){t.innerHTML=a,e.end.call(this,n)}.bind(this),800)}this.chat.appendChild(n)},Chat.prototype.addAnswer=function(t,e){var e=Object.assign({},{delay:0,end:function(){}},e);t.style.transform="translate( 0, 3em )",t.style.opacity="0",setTimeout(function(){t.style.transform="translate( 0, 0 )",t.style.opacity="1"},e.delay),t.addEventListener("transitionend",e.end.bind(this,t),!1),this.answers.appendChild(t)},Chat.prototype.animateAnswer=function(t,e){var e=Object.assign({},{end:function(){}},e);[].slice.call(t.parentNode.children).forEach(function(e){e!=t&&(e.style.transform="translate( 0, 3em )",e.style.opacity="0")});var n=t.cloneNode(!0);n.style.visibility="hidden",this.addBubble(n,{animate:!1});var a=n.getBoundingClientRect();n.style.display="none";var i=t.getBoundingClientRect();t.addEventListener("transitionend",function(){this.answers.innerHTML="",n.style.visibility="",n.style.display="",e.end.call(this)}.bind(this)),t.style.transform="translate("+(a.left-i.left)+"px,"+(a.top-i.top)+"px)"},Chat.prototype.chooseAnswer=function(t){(t=t instanceof Array?t:[t]).forEach(function(t,e){var n=this.createBubble(t.text,!0);n.addEventListener("click",function(){this.animateAnswer(n,{end:function(){"path"in t&&this.say(t.path),"callback"in t&&t.callback.call(this)}})}.bind(this)),this.addAnswer(n,{delay:50*e})}.bind(this))},Chat.prototype.writeAnswer=function(t){function e(){if(a.innerText){a.contentEditable=!1;var e=a.innerText;n.animateAnswer(a,{end:function(){"path"in t&&n.say(t.path),"callback"in t&&t.callback.call(n,e)}})}}var n=this,a=this.createBubble("",!0);a.classList.add("chat__bubble--input"),a.contentEditable=!0,a.addEventListener("paste",function(t){requestAnimationFrame(function(){a.innerHTML=a.innerText})}),a.addEventListener("blur",e),a.addEventListener("keydown",function(t){13==t.keyCode&&(t.preventDefault(),a.removeEventListener("blur",e),e())}),this.addAnswer(a,{end:function(){a.focus()}})},Chat.prototype.say=function(t){for(var e=(e=this.conversation[t])instanceof Array?e:[e],n=0;n<e.length;n++)setTimeout(function(t){if("object"==(void 0===t?"undefined":_typeof(t)))"choose"==t.type?this.chooseAnswer(t.answers):"text"==t.type&&this.writeAnswer(t);else{var e=this.createBubble(t);this.addBubble(e)}}.bind(this,e[n]),1200*n+350)},new Chat(document.getElementById("chat"),{start:["Moin!","Möchten Sie reden oder mir eine Nachricht senden?",{type:"choose",answers:[{text:"Was gibt's neues?",path:"whats-up"},{text:"Etwas schreiben!",path:"contact"}]}],"whats-up":"Also zu Zeit...",contact:["Dann erzähl mal!",{type:"text",path:"contact-thanks",callback:function(t){console.log(t)}}],"contact-thanks":["Vielen Dank für die Nachricht!","Ich brauche noch Ihre E-Mail Adresse, damit ich auf Sie zurückkommen kann.",{type:"text",callback:function(t){/[^@\s]+@[^@\s]+\.[^@\s]+/.test(t)?this.say("contact-success"):this.say("contact-wrong-email")}}],"contact-wrong-email":["Hmm","An der E-Mail Adresse kann etwas nicht stimmen","Möchten Sie Sie erneut schreiben?",{type:"choose",answers:[{text:"Ja",path:"contact-email-again"},{text:"Nein",path:"contact-no-email"}]}],"contact-email-again":{type:"text",callback:function(t){/[^@\s]+@[^@\s]+\.[^@\s]+/.test(t)?this.say("contact-success"):this.say("contact-wrong-email")}},"contact-no-email":["Kein Problem","Ich notiere mir die Nachricht trotzdem :-)"],"contact-success":["Vielen Dank!","Ich habe mir die Nachricht und Ihre E-Mail notiert :-)"]});
//# sourceMappingURL=chat.min.js.map
