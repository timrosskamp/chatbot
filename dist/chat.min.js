"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function Chat(t,e){t&&(this.canvas=t,this.conversation=e,this.chat=document.createElement("ul"),this.answers=document.createElement("div"),this.chat.className="chat__list",this.answers.className="chat__answers",this.canvas.appendChild(this.chat),this.canvas.appendChild(this.answers),this.say("start"))}Chat.prototype.createBubble=function(t,e){var a=document.createElement("div");return a.className=1==e?"chat__bubble chat__bubble--response":"chat__bubble",a.innerHTML=t,a},Chat.prototype.addBubble=function(t,e){e=Object.assign({},{end:function(){},animate:!0},e);var a=document.createElement("li");if(a.className="chat__item",a.appendChild(t),1==e.animate){var n=t.innerHTML;t.innerHTML="‚Ä¶",t.style.transform="translate( -4em, 0 )",t.style.opacity="0",setTimeout(function(){t.style.transform="translate( 0, 0 )",t.style.opacity="1"},30),setTimeout(function(){t.innerHTML=n,e.end.call(this,a)}.bind(this),800)}this.chat.appendChild(a)},Chat.prototype.addAnswer=function(t,e){e=Object.assign({},{delay:0,end:function(){}},e);t.style.transform="translate( 0, 3em )",t.style.opacity="0",setTimeout(function(){t.style.transform="translate( 0, 0 )",t.style.opacity="1"},e.delay),t.addEventListener("transitionend",e.end.bind(this,t),!1),this.answers.appendChild(t)},Chat.prototype.animateAnswer=function(e,t){t=Object.assign({},{end:function(){}},t);[].slice.call(e.parentNode.children).forEach(function(t){t!=e&&(t.style.transform="translate( 0, 3em )",t.style.opacity="0")});var a=e.cloneNode(!0);a.style.visibility="hidden",this.addBubble(a,{animate:!1});var n=a.getBoundingClientRect();a.style.display="none";var s=e.getBoundingClientRect();e.addEventListener("transitionend",function(){this.answers.innerHTML="",a.style.visibility="",a.style.display="",t.end.call(this)}.bind(this)),e.style.transform="translate("+(n.left-s.left)+"px,"+(n.top-s.top)+"px)"},Chat.prototype.chooseAnswer=function(t){(t=t instanceof Array?t:[t]).forEach(function(t,e){var a=this.createBubble(t.text,!0);a.addEventListener("click",function(){this.animateAnswer(a,{end:function(){"path"in t&&this.say(t.path),"callback"in t&&t.callback.call(this)}})}.bind(this)),this.addAnswer(a,{delay:50*e})}.bind(this))},Chat.prototype.writeAnswer=function(e){var a=this,n=this.createBubble("",!0);function s(){if(n.innerText){n.contentEditable=!1;var t=n.innerText;a.animateAnswer(n,{end:function(){"path"in e&&a.say(e.path),"callback"in e&&e.callback.call(a,t)}})}}n.classList.add("chat__bubble--input"),n.contentEditable=!0,n.addEventListener("paste",function(t){requestAnimationFrame(function(){n.innerHTML=n.innerText})}),n.addEventListener("blur",s),n.addEventListener("keydown",function(t){13==t.keyCode&&(t.preventDefault(),n.removeEventListener("blur",s),s())}),this.addAnswer(n,{end:function(){n.focus()}})},Chat.prototype.say=function(t){for(var e=(e=this.conversation[t])instanceof Array?e:[e],a=0;a<e.length;a++)setTimeout(function(t){if("object"==(void 0===t?"undefined":_typeof(t)))"choose"==t.type?this.chooseAnswer(t.answers):"text"==t.type&&this.writeAnswer(t);else{var e=this.createBubble(t);this.addBubble(e)}}.bind(this,e[a]),1200*a+350)},new Chat(document.getElementById("chat"),{start:["Hi!","What's up?","Do you want to talk, or send me a message?",{type:"choose",answers:[{text:"I'd prefer to talk.",path:"just-talk"},{text:"Send a message!",path:"contact"}]}],"just-talk":["Okay!","I just build this chatbot! Isn't it amazing?","What do you think about it?",{type:"choose",answers:[{text:"It's great!",path:"great-chatbot"},{text:"I don't like it.",path:"dont-like-it"}]}],"great-chatbot":["Thanks! ‚ù§",'You can check out the sourcecode at <a target="_blank" href="https://github.com/timrosskamp/chatbot">github.com/timrosskamp/chatbot</a>.'],"dont-like-it":["Oh üòû","Are you sure you don't like me?",{type:"choose",answers:[{text:"Okay. I like you!",path:"great-chatbot"}]}],contact:["Alright!","Just type what you have in mind.",{type:"text",path:"contact-thanks",callback:function(t){console.log(t)}}],"contact-thanks":["Great message!","I just need your email so I can get back to you!",{type:"text",callback:function(t){/[^@\s]+@[^@\s]+\.[^@\s]+/.test(t)?this.say("contact-success"):this.say("contact-wrong-email")}}],"contact-wrong-email":["Hmm.","I don't think this is a valid email address.","Do you wan't to try again?",{type:"choose",answers:[{text:"Yes!",path:"contact-email-again"},{text:"No.",path:"contact-no-email"}]}],"contact-email-again":{type:"text",callback:function(t){/[^@\s]+@[^@\s]+\.[^@\s]+/.test(t)?this.say("contact-success"):this.say("contact-wrong-email")}},"contact-no-email":["No problem!","I'm a chatbot anyway, not a postman üòÅ"],"contact-success":["Thank you very much!","But I did't send anything üòâ","I'm a chatbot, not a postman üòÅ"]});
//# sourceMappingURL=chat.min.js.map
